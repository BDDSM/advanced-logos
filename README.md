# `advanced-logos`

[![Stars](https://img.shields.io/github/stars/khorevaa/advanced-logos.svg?label=Github%20%E2%98%85&a)](https://github.com/khorevaa/advanced-logos/stargazers)
[![Release](https://img.shields.io/github/tag/khorevaa/advanced-logos.svg?label=Last%20release&a)](https://github.com/khorevaa/advanced-logos/releases)
[![Открытый чат проекта https://gitter.im/EvilBeaver/oscript-library](https://badges.gitter.im/khorevaa/advanced-logos.png)](https://gitter.im/EvilBeaver/oscript-library)

[![Build Status](https://travis-ci.org/khorevaa/advanced-logos.svg?branch=master)](https://travis-ci.org/khorevaa/advanced-logos)
[![Coverage Status](https://coveralls.io/repos/github/khorevaa/advanced-logos/badge.svg?branch=master)](https://coveralls.io/github/khorevaa/advanced-logos?branch=master)

# Библиотека `advanced-logos`

> Библиотека добавляет форматеры/раскладки сообщений и цветной вывод лога в консоль для работы с логами из библиотеки `logos`

* Вывод лога в стандартной раскладке
    ![Пример вывода лога](img/example_en.png)
* Вывод лога в русской раскладке
    ![Пример вывода лога](img/example_ru.png)

## Особенности

* Для вывода в цветную консоль используется форматирование сообщения с помощью класса `УлучшенныйФорматЛога`
  Другое форматирование (раскладки) сообщения игнорируется. 

* Для работы требуется библиотека `logos` из ветки https://github.com/khorevaa/logos/tree/feature/struct-logs& Ждем принятия PR

## Возможности

* Красивый и цветной вывода логов в консоль
* Вывод префиксов сообщений (дополнительной информации после уровня сообщения, по умолчанию это имя лога)
* Вывод даты события в читаемом формате с милисекундами
* Вывод цветных ключей дополнительных полей
* Цветовая раскраска по уровням сообщения
* `Две` встроенные карты названий сообщений (RU и ENG) 
* Возможность задать свою карту названий уровней сообщений
* Возможность задать свой формат даты события сообщений
* Возможность задать свою цветовую гамму уровней сообщений, даты события и префикса
* Возможность отключать вывод даты, префиксов и цвета
* 2 форматера (`раскладки`) сообщений:
    * `УлучшенныйФорматЛога` - используется для раскраски при выводе лога в консоль, но может быть использовать самостоятельно, имеет ряд настроек.
    * `JSONФорматЛога` - используется для формирования данных события лога в json-формате. Формат легко читается любыми лог-анализаторами

## Установка

Для установки необходимо:
* Скачать файл advanced-logos*.ospx из раздела [releases](https://github.com/khorevaa/advanced-logos/releases)
* Воспользоваться командой:

```
opm install -f <ПутьКФайлу>
```
или установить с хаба пакетов

```
opm install advanced-logos
```

## Пример работы

* Добавление как способа вывода логов
```bsl

    Лог = Логирование.ПолучитьЛог("oscript.lib.logos");
    ЦветнойВывод = Новый ЦветнойВыводЛогаКонсоль;
    Лог.ДобавитьСпособВывода(ЦветнойВывод);

    Лог.Информация("Сообщение лога");
    
```

* Вывод информации с префиксом
```bsl

    Лог = Логирование.ПолучитьЛог("oscript.lib.logos");
    ЦветнойВывод = Новый ЦветнойВыводЛогаКонсоль;
    Лог.ДобавитьСпособВывода(ЦветнойВывод);

    Лог.Поля("prefix", "connect").Информация("Сообщение лога");
    
```

* Вывод информации в json формате
```bsl

    Лог = Логирование.ПолучитьЛог("oscript.lib.logos");
     JSONФорматЛога = Новый JSONФорматЛога;
    ДобавитьСебяКакОбработчикаВывода();

    Лог.УстановитьРаскладку(JSONФорматЛога);
    
    Лог.Поля("prefix", "connect", "корова", 200, "адрес", "server.com").Ошибка("Вывод 
    | ошибка");
    
    // {"time":"2019-02-03T14:16:13.745Z","level":"ERROR","msg":"Вывод \n ошибка","log":"testing","prefix":"connect","корова":200,"адрес":"server.com"}

```


> Больше примеров смотри [тут](/tests/ЦветнойВыводЛогаКонсоль_test.os)

## Публичный интерфейс

[Документация публичного интерфейса (в разработке)](docs/README.md)

## Доработка

Доработка проводится по git-flow. Жду ваших PR.

## Лицензия

Смотри файл [`LICENSE`](LICENSE).
